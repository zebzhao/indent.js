!function(n,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():n.indent=e()}(this,function(){var n=function(n){function e(n,e){if(u[n])return u[n];var t=[];u[n]=t;for(var s=0;s<e.length;s++)e[s].langs.indexOf(n.toLowerCase())!=-1&&t.push(e[s]);return t}function t(n,t,d){function u(n){A=n.cursor,m=n.countdown;var t=n.rule,s=y+1+(t.lineOffset||0);n.line=s,w.push(n),t.debug,t.indent&&I[s].push(!t.matchLineIndent),t.rules&&(k=e(t.rules)),t.scope&&b.push(null)}function g(){var n=w.pop(),e=n.line,t=n.rule;if(t.debug,t.indent){var s=t.endsIndent||0!==f.matchIndex?1:0;j[y+s].push(f.softIndent?-e:e)}t.rules&&(k=null),t.scope&&b.pop(),b[b.length-1]=t,m=w.length?w[w.length-1].rule.countdown:0}function h(n,e,t){n=n.substring(t,n.length);for(var s,a,r,l,c=null,d=n.length,o=0;o<e.length;o++)l=e[o],r=b[b.length-1],(!l.lastRule||r&&l.lastRule.indexOf(r.name)!==-1)&&(a=i(n,l.starts,l),a.matchIndex!=-1&&a.matchIndex<d&&(!l.head||0==t)&&(d=a.matchIndex,s=a,c=l));return{rule:c,matchIndex:c?d+t:-1,cursor:c?t+s.cursor:-1,state:a.state}}for(var m,f,v,x=n.split(/[\r]?\n/gi),p=x.length,I=s(p),j=s(p),w=[],b=[null],y=0,A=0,k=null;y<p;){var O=x[y].trim(),z=c(O)+"\r\n";if(v=h(z,k||t,A),w.length){var Z=w[w.length-1];if(f=o(z,Z,A),f.matchIndex==-1){if(Z.rule.ignore){y++,A=0;continue}m&&(m--,0===m&&g())}else if(Z.rule.ignore||v.matchIndex==-1||f.matchIndex<=v.matchIndex){g(),A=f.cursor;continue}}v.matchIndex!=-1?u(v):(y++,A=0)}console.log(j),console.log(I);var R,C,E,L,S,$,H,J=0,M=a(p),T=a(p),_=[];for($=0;$<p;$++){for(R=r(I[$]),C=I[$].length-R,M[$]=R,E=j[$],S=0,H=0;H<E.length;H++)L=E[H],M[L]>0&&(M[L]--,S+=L!==$);R=M[$]>0?j[$+1].length>0?C+1:1:0,M[$]=R,T[$]=R-S}for($=0;$<p;$++)J+=T[$]||0,_.push((J>0?l(d,J):"")+x[$].trim());return console.log(M),console.log(T),_.join("\r\n")}function s(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function a(e){if(n.Int16Array)return new Int16Array(e);for(var t=new Array(e),s=0;s<e;s++)t[s]=0;return t}function r(n){var e,t=0;for(e=0;e<n.length;e++)t+=!!n[e];return t}function l(n,e){return new Array(e+1).join(n)}function c(n){return n.replace(/\\(u[0-9A-Za-z]{4}|u\{[0-9A-Za-z]{1,6}]\}|x[0-9A-Za-z]{2}|.)/g,"0")}function d(n,e,t){if(e.debug,t.newline){var s=n.search(/\r*\n/);if(s!==-1)return{matchIndex:s,length:1}}else t.newline=n.search(/[^\s\r\n]/)!==-1;return null}function o(n,e,t){n=n.substr(t,n.length);var s=e.rule,a=!1,r=i(n,s.ends,s,e.state);s.softEnds&&(r=i(n,s.softEnds,s,e.state),a=r.matchIndex!==-1);var l=s.advance?r.cursor:r.matchIndex;return{matchIndex:r.matchIndex===-1?-1:r.matchIndex+t,cursor:l==-1?-1:l+t,softIndent:a,state:r.state}}function i(n,e,t,s){s=s||{};for(var a,r,l=-1,c=0,d=0;d<e.length;d++)if(r=e[d],"function"==typeof r){if(a=r(n,t,s)){l=a.matchIndex,c=a.length;break}}else if(a=n.match(r)){l=n.search(r),c=a[0].length;break}return{matchIndex:l,cursor:l+c,state:s}}var u={},g=/\r*\n/,h=/;/,m=[{langs:"html",name:"comment",starts:[/\<\!\-\-/],ends:[/\-\-\>/],ignore:!0,advance:!0},{langs:"html",name:"doctype",starts:[/\<\!doctype html>/i],ends:[g],ignore:!0,advance:!0},{langs:"html",name:"link|br|hr|input|img|meta",starts:[/\<(link|br|hr|input|img|meta)/i],ends:[/>/],advance:!0},{langs:"html",name:"mode switch js",starts:[function(n){var e=/<script[\s>].*/i,t=/<\/script>/i,s=e.exec(n),a=t.exec(n);return s&&(!a||a.index<s.index)?{matchIndex:s.index,length:s[0].length}:null}],ends:[/<\/script>/i],rules:"js",advance:!0,indent:!0,scope:!0},{langs:"html",name:"mode switch css",starts:[function(n){var e=/<style[\s>].*/i,t=/<\/style>/i,s=e.exec(n),a=t.exec(n);return s&&(!a||a.index<s.index)?{matchIndex:s.index,length:s[0].length}:null}],ends:[/<\/style>/i],rules:"css",advance:!0,indent:!0,scope:!0},{langs:"html",name:"close-tag",starts:[/<\/[A-Za-z0-9\-]+>/],ends:[/./],indent:!0},{langs:"html",name:"tag-attr",starts:[/<[A-Za-z0-9\-]+/],ends:[/>/],indent:!0},{langs:"html",name:"tag",starts:[/>/],ends:[/<\/[A-Za-z0-9\-]+>/],indent:!0,advance:!0},{langs:"js",name:"line-comment",starts:[/\/\//],ends:[g],ignore:!0},{langs:"js css",name:"block-comment",starts:[/\/\*/],ends:[/\*\//],ignore:!0},{langs:"js",name:"regex",starts:[function(n,e){var t=/[(,=:[!&|?{};][\s]*\/[^\/]|^[\s]*\/[^\/]/,s=n.search(t);if(s!=-1){s=n.indexOf("/",s);var a=n.substring(s+1),r=i(a,e.ends,e);if(r.matchIndex!=-1){a=a.substring(0,r.matchIndex);try{return new RegExp(a),{matchIndex:s,length:1}}catch(l){return null}}}return null}],ends:[function(n){for(var e=0,t=n.indexOf("/");t!=-1;)try{new RegExp(n.substring(0,t));break}catch(s){t=n.indexOf("/",e),e=t+1}return t==-1?null:{matchIndex:t,length:1}}],ignore:!0,advance:!0},{langs:"js css html",name:"string",starts:[/\"/],ends:[/\"/,g],ignore:!0,advance:!0},{langs:"js css html",name:"string",starts:[/\'[^']/],ends:[/[^\\]\'/,g],ignore:!0,advance:!0},{langs:"js css html",name:"string",starts:[/\`[^`]/],ends:[/[^\\]\`/],ignore:!0,advance:!0},{langs:"js",name:"if",starts:[/^if[\s]*(?=\()/,/[\s]+if[\s]*(?=\()/],ends:[/else[\s]+/,/\{/,h],countdown:2,indent:!0},{langs:"js",name:"for",starts:[/^for[\s]*(?=\()/],ends:[/\{/,h],countdown:2,indent:!0},{langs:"js",name:"else",starts:[/else[\s]+/],ends:[/if/,/\{/,h],countdown:2,indent:!0},{langs:"js css",name:"bracket",starts:[/\([\s]*(var)?/],ends:[/\)/],indent:!0,advance:!0,scope:!0},{langs:"js",name:"dot-chain",starts:[/^\.[A-Za-z$_]/],ends:[h,/\./,d],indent:!0,head:!0,lineOffset:-1},{langs:"js",name:"dot-chain",starts:[/\.\s*\r*\n/],ends:[/[^\s]\s*\r*\n/],indent:!0},{langs:"js css",name:"array",starts:[/\[/],ends:[/]/],indent:!0,advance:!0,scope:!0},{langs:"js css",name:"block",starts:[/\{/],ends:[/}/],indent:!0,advance:!0,scope:!0},{langs:"js",name:"var/let/const",starts:[/(var|let|const)[\s]*\r*\n/],ends:[/[\w$]/],indent:!0,endsIndent:!0},{langs:"js",name:"var/let/const",starts:[/(var|let|const)[\s]+[\w$]+/],ends:[/./]},{langs:"js",name:"var/let/const",lastRule:["var/let/const","="],starts:[/,[\s]*\r*\n/],ends:[d],indent:!0},{langs:"js",name:"var/let/const",lastRule:["var/let/const","="],starts:[/^,/],ends:[/./],head:!0,indent:!0,lineOffset:-1},{langs:"js",name:"=",starts:[/=/],ends:[d,/,/],indent:!0,matchLineIndent:!0,debug:!0},{langs:"js",name:"case",starts:[/^case[\s]+/],ends:[/break[\s;]+/,/^case[\s]+/,/^default[\s]+/,/^return([\s]+|;)/,/}/],endsIndent:!0,indent:!0,scope:!0},{langs:"js",name:"default",starts:[/^default[\s]*:/],ends:[/break[\s;]+/,/^case[\s]+/,/^default[\s]+/,/^return([\s]+|;)/,/}/],endsIndent:!0,indent:!0,scope:!0},{langs:"js",name:"semicolon",starts:[h],ends:[/./]}],f=e("css",m),v=e("js",m),x=e("html",m),p={css:function(n,e){return t(n||"",f,void 0===e?"\t":e)},js:function(n,e){return t(n||"",v,void 0===e?"\t":e)},html:function(n,e){return t(n||"",x,void 0===e?"\t":e)},indentJS:function(n,e){return console&&console.warn&&console.warn("Calling deprecated function!"),p.js(n,e)},indentCSS:function(n,e){return console&&console.warn&&console.warn("Calling deprecated function!"),p.css(n,e)},indentHTML:function(n,e){return console&&console.warn&&console.warn("Calling deprecated function!"),p.html(n,e)}};return p}(this);return n});